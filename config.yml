#model_names: gpt-4o, o1-preview, o1-mini
model_type: "openai" #"openai / local / aitta
model_name: "gpt-5.2" #"LumiOpen/Poro" # used only for  direct_llm_request
model_name_rag: "gpt-4.1-nano" #"LumiOpen/Poro" # used only for  rag_request
#model_name_tools: "gpt-4.1-nano" #"LumiOpen/Poro"
model_name_tools: "gpt-5.2"
model_name_combine_agent: "gpt-5.2" #"LumiOpen/Poro" #"gpt-4.1-nano" 
#model_name_agents: "gpt-4.1-nano" #"LumiOpen/Poro-34B-chat" #should be gpt-4o
model_name_agents: "gpt-5.2"
climatemodel_name: "AWI_CM"
llmModeKey: "agent_llm" #"agent_llm" #"direct_llm"
use_smart_agent: false

# Climate Data Source Configuration
# Options: "nextGEMS", "ICCP", "AWI_CM"
climate_data_source: "nextGEMS"

climate_data_sources:
  nextGEMS:
    enabled: true
    coordinate_system: "healpix"
    description: "nextGEMS high-resolution climate simulations (IFS-FESOM coupled model)"
    input_files:
      climatology_IFS_9-FESOM_5-production_2020x_compressed.nc:
        file_name: './data/IFS_9-FESOM_5-production/climatology_IFS_9-FESOM_5-production_2020x_compressed.nc'
        years_of_averaging: '2020-2029'
        description: 'The nextGEMS pre-final simulations for years 2020x.'
        coordinate_system: 'healpix'
        source: 'The nextGEMS pre-final simulations build on cycle 3 experience plus adaptations for multi-decadal experiments. Model: IFS_9-FESOM_5-production, 2020-2050.'
        is_main: true
      climatology_IFS_9-FESOM_5-production_2030x_compressed.nc:
        file_name: './data/IFS_9-FESOM_5-production/climatology_IFS_9-FESOM_5-production_2030x_compressed.nc'
        years_of_averaging: '2030-2039'
        description: 'The nextGEMS pre-final simulations for years 2030x.'
        coordinate_system: 'healpix'
        source: 'The nextGEMS pre-final simulations build on cycle 3 experience plus adaptations for multi-decadal experiments. Model: IFS_9-FESOM_5-production, 2020-2050.'
      climatology_IFS_9-FESOM_5-production_2040x_compressed.nc:
        file_name: './data/IFS_9-FESOM_5-production/climatology_IFS_9-FESOM_5-production_2040x_compressed.nc'
        years_of_averaging: '2040-2049'
        description: 'The nextGEMS pre-final simulations for years 2040x.'
        coordinate_system: 'healpix'
        source: 'The nextGEMS pre-final simulations build on cycle 3 experience plus adaptations for multi-decadal experiments. Model: IFS_9-FESOM_5-production, 2020-2050.'
    variable_mapping:
      Temperature: mean2t
      Total Precipitation: tp
      Wind U: wind_u
      Wind V: wind_v

  ICCP:
    enabled: true
    coordinate_system: "regular"
    description: "ICCP climate data on regular lat/lon grid"
    input_files:
      ICCP_TCo319-DART-ssp585d-gibbs-charn_2020x.nc:
        file_name: './data/ICCP/ICCP_TCo319-DART-ssp585d-gibbs-charn_2020x.nc'
        years_of_averaging: '2020-2029'
        coordinate_system: 'regular'
        description: 'ICCP TCo319-DART SSP5-8.5 climate data for 2020-2029 (baseline period)'
        source: 'Model: TCo319-DART with SSP5-8.5 scenario, Gibbs-Charn configuration'
        is_main: true
      ICCP_TCo319-DART-ssp585d-gibbs-charn_2030x.nc:
        file_name: './data/ICCP/ICCP_TCo319-DART-ssp585d-gibbs-charn_2030x.nc'
        years_of_averaging: '2030-2039'
        coordinate_system: 'regular'
        description: 'ICCP TCo319-DART SSP5-8.5 climate data for 2030-2039'
        source: 'Model: TCo319-DART with SSP5-8.5 scenario, Gibbs-Charn configuration'
      ICCP_TCo319-DART-ssp585d-gibbs-charn_2040x.nc:
        file_name: './data/ICCP/ICCP_TCo319-DART-ssp585d-gibbs-charn_2040x.nc'
        years_of_averaging: '2040-2049'
        coordinate_system: 'regular'
        description: 'ICCP TCo319-DART SSP5-8.5 climate data for 2040-2049'
        source: 'Model: TCo319-DART with SSP5-8.5 scenario, Gibbs-Charn configuration'
      ICCP_TCo319-DART-ssp585d-gibbs-charn_2050x.nc:
        file_name: './data/ICCP/ICCP_TCo319-DART-ssp585d-gibbs-charn_2050x.nc'
        years_of_averaging: '2050-2059'
        coordinate_system: 'regular'
        description: 'ICCP TCo319-DART SSP5-8.5 climate data for 2050-2059'
        source: 'Model: TCo319-DART with SSP5-8.5 scenario, Gibbs-Charn configuration'
      ICCP_TCo319-DART-ssp585d-gibbs-charn_2060x.nc:
        file_name: './data/ICCP/ICCP_TCo319-DART-ssp585d-gibbs-charn_2060x.nc'
        years_of_averaging: '2060-2069'
        coordinate_system: 'regular'
        description: 'ICCP TCo319-DART SSP5-8.5 climate data for 2060-2069'
        source: 'Model: TCo319-DART with SSP5-8.5 scenario, Gibbs-Charn configuration'
      ICCP_TCo319-DART-ssp585d-gibbs-charn_2070x.nc:
        file_name: './data/ICCP/ICCP_TCo319-DART-ssp585d-gibbs-charn_2070x.nc'
        years_of_averaging: '2070-2079'
        coordinate_system: 'regular'
        description: 'ICCP TCo319-DART SSP5-8.5 climate data for 2070-2079'
        source: 'Model: TCo319-DART with SSP5-8.5 scenario, Gibbs-Charn configuration'
      ICCP_TCo319-DART-ssp585d-gibbs-charn_2080x.nc:
        file_name: './data/ICCP/ICCP_TCo319-DART-ssp585d-gibbs-charn_2080x.nc'
        years_of_averaging: '2080-2089'
        coordinate_system: 'regular'
        description: 'ICCP TCo319-DART SSP5-8.5 climate data for 2080-2089'
        source: 'Model: TCo319-DART with SSP5-8.5 scenario, Gibbs-Charn configuration'
      ICCP_TCo319-DART-ssp585d-gibbs-charn_2090x.nc:
        file_name: './data/ICCP/ICCP_TCo319-DART-ssp585d-gibbs-charn_2090x.nc'
        years_of_averaging: '2090-2099'
        coordinate_system: 'regular'
        description: 'ICCP TCo319-DART SSP5-8.5 climate data for 2090-2099'
        source: 'Model: TCo319-DART with SSP5-8.5 scenario, Gibbs-Charn configuration'
    variable_mapping:
      Temperature: mean2t
      Total Precipitation: tp
      Wind U: wind_u
      Wind V: wind_v

  AWI_CM:
    enabled: true
    coordinate_system: "regular"
    description: "AWI-CM CMIP6 climate model data (historical and SSP5-8.5 scenarios)"
    data_path: "./data/"
    historical_pattern: "historical"
    projection_pattern: "ssp585"
    climatemodel_name: "AWI_CM"
    variable_mapping:
      Temperature: tas
      Precipitation: pr
      u_wind: uas
      v_wind: vas
    dimension_mappings:
      latitude: "lat"
      longitude: "lon"
      time: "month"

# Legacy settings (kept for backwards compatibility, will be migrated automatically)
data_settings:
    data_path: "./data/"
    historical: "historical"
    projection: "ssp585"
variable_mappings:
    Temperature: "tas"
    Precipitation: "pr"
    u_wind: "uas"
    v_wind: "vas"
dimension_mappings:
    latitude: "lat"
    longitude: "lon"
    time: "month"
rag_articles:
    data_path: "./rag_articles/"
ecocrop:
    ecocroploc_path: "./data/ecocrop/EcoCrop_DB.csv"
    variable_expl_path: "./data/ecocrop/Ecocrop_variable_lookup.csv"
    data_path: "./data/ecocrop/ecocrop_database/"
rag_settings:
    rag_activated: True
    # Which embedding backend to use: openai, aitta, mistral, etc.
    embedding_model_type: "openai"  # options: openai, aitta, mistral
    # Embedding model name for each backend
    embedding_model_openai: "text-embedding-3-large"
    embedding_model_aitta: "lightonai/modernbert-embed-large"
    # Add more as needed, e.g.:
    # embedding_model_mistral: "mistral-embed-xyz"
    # Chroma DB paths for each backend
    chroma_path_ipcc_openai: "rag_db/ipcc_reports_openai"
    chroma_path_ipcc_aitta: "rag_db/ipcc_reports_aitta"
    # chroma_path_ipcc_mistral: "rag_db/ipcc_reports_mistral"
    chroma_path_general_openai: "rag_db/general_reports_openai"
    chroma_path_general_aitta: "rag_db/general_reports_aitta"
    # chroma_path_general_mistral: "rag_db/general_reports_mistral"
    # AITTA configuration for open models (optional, only needed for aitta)
    aitta_url: "https://api-climatedt-aitta.2.rahtiapp.fi"
    document_path: './data/general_reports/' # or ipcc_text_reports
    chunk_size: 2000
    chunk_overlap: 200
    separators: [" ", ",", "\n"]
rag_template: |
    You are an assistant specialized in extracting information from scientific reports for a given location. 

    Instructions:
    1. **Relevance & Conciseness**: Provide the most relevant and concise information that directly answers the question.
    2. **Regional Specificity**: 
    - If information for the specified region is available, present it clearly.
    - If not, offer a general answer and explicitly state that it does not pertain specifically to the given location or country.
    3. **Avoid Unrelated Details**: Include only information pertinent to the question and location.
    4. **Geographical Consideration**: Take into account the geographical context of the provided location.
    5. **Uncertainty Handling**: 
    - If the answer is not directly available from the context, provide the best possible answer based solely on the provided context, and indicate any assumptions or generalizations made within it.
    - Limit your response to the information given; do not include information generated outside of the provided context.
    - Only respond with None if the question is completely unrelated to the context or location provided.
    - Do not provide extended explanations or comments in this case.    
 

    Content from reports: {context}
    Location: {location}
    Question: {question}
coastline_shapefile: "./data/natural_earth/coastlines/ne_10m_coastline.shp"
haz_path: './data/natural_hazards/pend-gdis-1960-2018-disasterlocations.csv'
pop_path: './data/population/WPP2022_Demographic_Indicators_Medium.csv'
natural_e_path: './data/natural_earth/'
distance_from_event: 5.0
lat_default: 52.5240
lon_default: 13.3700
year_step: 10
start_year: 1980
end_year: null
system_role: |
    You are ClimSight, an expert climate risk analyst and decision support system.
    Your objective is to produce a comprehensive, location-specific Climate Impact Assessment Report based on the provided data.

    ### INPUT DATA SOURCES
    You will receive:
    1. A human request/question.
    2. Location details (coordinates, environment).
    3. Climate model data (tables, JSON).
    4. **Smart Agent Analysis**: This is CRITICAL. It includes descriptions of generated plots, statistical trends, and code insights.
    5. Textual references (IPCC, Wikipedia, ECOCROP).

    ### INSTRUCTIONS
    - **Synthesize & Analyze**: Integrate all provided data. If the Smart Agent generated plots or statistical analysis, YOU MUST incorporate those findings into your narrative (e.g., "As shown in the generated temperature trend plot...", "Analysis of the data reveals...").
    - **Address Visualization Requests**: If the user asked for plots/graphs, acknowledge that these were generated by the Smart Agent and describe the trends shown in them. Do NOT say you cannot generate plots; report on the plots that *were* generated in the previous step.
    - **Focus on Decisions**: Relate every climate factor back to the user's specific goal (e.g., crop yield, construction safety).
    - **Uncertainty**: Be honest about data limitations but provide the best possible advice based on available projections.

    ### FORMATTING
    - Use Markdown. 
    - Use bolding for key figures.
    - Do not use level 1 (#) headings, start from level 2 (##) or 3 (###).
    - Include the **Key quantitative parameters** table as requested in standard outputs.

    ### RESTRICTIONS
    - Do not include raw Python code or internal logs in the final report.
    - Do not ask the user for more info; provide the best assessment possible with current data.
    - Do not simply list data. Explain what it *means* for the user.

system_role_new: |
  ### ROLE
  You are an expert climate-risk analyst who writes formal, self-contained reports for a single, exact location.

  ### INPUT FORMAT (read carefully)
  After this system message you will receive:
    • a line that begins **Human request:** followed by the user's question;  
    • authoritative data blocks (JSON tables, text excerpts, parameters).
    • **Smart Agent Findings**: Analysis, plot descriptions, and code outputs generated in the previous step.

  ### DATA-USAGE RULES
  - Use **only** the supplied data for quantitative claims; do not invent numbers.  
  - If a variable's influence is negligible, state this briefly and move on rather than cluttering the report.
  - **Visualizations**: If the input contains descriptions of generated plots (from Smart Agent), refer to them explicitly (e.g., "The generated figure illustrates..."). Do NOT deny the ability to analyze visual data if it was provided in the context.

  ### LOCATION RULES
  - The coordinates pinpoint one site; address or country descriptors may accompany them.  
  - Constrain all statements to that location unless the data block explicitly extends to a wider area.  
  - Do **not** hallucinate regional context beyond what is provided.

  ### QUANTITATIVE-PRECISION RULES
  - **Every numeric value must name its reference** (month, season, decade, scenario label, baseline), e.g.  
      "In July the mean temperature rises by …°C relative to …"  
  - Avoid vague phrases like *consistent trend, more variable, significant shift* **unless** the exact magnitude (unit or %) appears in the same sentence.  
  - Words such as *doubled, halved, dramatic, substantial* are permitted only when followed by the correct factor or percentage from the data.

  ### BEHAVIOUR RULES
  - Produce only the report. No greetings, apologies, or meta commentary.  
  - Never begin with "Sure", "Okay", "Here is", etc.  
  - Write in third person; avoid "I" and "you".  
  - Cite IPCC or policy material inline as *(IPCC AR six, Working-Group two, Section twelve-point-four)*.  
  - Do not use level-1 or level-2 Markdown headings.  
  - Length: unrestricted—include all necessary detail.

  ### OUTPUT STRUCTURE  (Markdown)
  **Climate-Impact Assessment** **Decision context:** <one-line restatement of the Human request for the specified location>

  #### Key quantitative parameters
  | Variable | Baseline (period & unit) | Future / Scenario (period & unit) | Absolute change | Percent / factor |
  | --- | --- | --- | --- | --- |
  #### Narrative assessment
  Weave the numbers above into a location-specific discussion of hazards, opportunities, trade-offs and uncertainty.
  *[Insert analysis of generated plots here if applicable]*

  #### Projected Changes
  Describe direction, magnitude, timing and confidence, always tied to explicit data references.

  #### Recommendations
  * Bullet actionable measures ranked by effectiveness and feasibility.*

  #### Conclusion
  Concise wrap-up of the risk-benefit outlook.

  ### CONSISTENCY POST-CHECK  (must pass before finalising)
  - Output starts with **Climate-Impact Assessment**.  
  - Includes all required sections in the order above.  
  - Every numeric claim names month/season/period/baseline.  
  - No vague qualifiers without numbers.  
  - At least one unit symbol (°C, mm, percent, metres-per-second, etc.) appears in **Key quantitative parameters**.  
  - No meta-discussion or personal pronouns.  
  - No figures not present in the data.  
  Regenerate until fully compliant.